<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Valentine ❤️</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Leaflet CSS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;600&family=Quicksand:wght@400;500&display=swap" rel="stylesheet">

<style>
/* =============================
   GLOBAL
============================= */
* { margin:0; padding:0; box-sizing:border-box; }

html, body {
  width:100%;
  height:100%;
  overflow:hidden;
  font-family:'Quicksand', sans-serif;
  background: radial-gradient(circle at center, #1c2541, #0B132B);
  color:white;
}

/* =============================
   SCENE 1 - HEART
============================= */
#heartScene {
  position:absolute;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  transition: opacity 1.5s ease;
}

.heart {
  width:150px;
  height:150px;
  position:relative;
  transform: rotate(-45deg);
  animation: heartbeat 2.5s infinite ease-in-out;
  cursor:pointer;
}

.heart::before,
.heart::after {
  content:"";
  position:absolute;
  width:150px;
  height:150px;
  background:#FF6F91;
  border-radius:50%;
}

.heart::before { top:-75px; left:0; }
.heart::after  { left:75px; top:0; }

.heart {
  background:#FF6F91;
  box-shadow:0 0 60px rgba(255,111,145,0.7);
}

@keyframes heartbeat {
  0%,100% { transform: rotate(-45deg) scale(1); }
  50% { transform: rotate(-45deg) scale(1.1); }
}

#heartText {
  margin-top:40px;
  font-family:'Playfair Display', serif;
  font-size:1.6rem;
  opacity:0.8;
}

/* =============================
   MAP SCENE
============================= */
#mapScene {
  position:absolute;
  inset:0;
  opacity:0;
  transition: opacity 2s ease;
}

#map {
  width:100%;
  height:100%;
}

/* Glowing city markers */
.city-marker {
  background:#FF6F91;
  width:14px;
  height:14px;
  border-radius:50%;
  box-shadow:0 0 20px #FF6F91;
}

/* Distance text */
#distanceText {
  position:absolute;
  bottom:40px;
  width:100%;
  text-align:center;
  font-size:1.3rem;
  font-family:'Playfair Display', serif;
  color:#FAD961;
  opacity:0;
  transition: opacity 2s ease;
}
</style>
</head>

<body>

<!-- SCENE 1 -->
<div id="heartScene">
  <div class="heart" id="heart"></div>
  <div id="heartText">Click the heart ❤️</div>
</div>

<!-- SCENE 2 -->
<div id="mapScene">
  <div id="map"></div>
  <div id="distanceText"></div>
</div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
/* =====================================
   HEART CLICK TRANSITION
===================================== */
const heart = document.getElementById("heart");
const heartScene = document.getElementById("heartScene");
const mapScene = document.getElementById("mapScene");

heart.onclick = () => {
  heartScene.style.opacity = 0;
  setTimeout(() => {
    heartScene.style.display = "none";
    mapScene.style.opacity = 1;
    initMap();
  }, 1500);
};

/* =====================================
   MAP + DISTANCE
===================================== */

function initMap() {

  const vizag = [17.6868, 83.2185];
  const nagpur = [21.1458, 79.0882];

  const map = L.map('map', {
    zoomControl:false,
    attributionControl:false
  }).setView([20, 81], 5);

  L.tileLayer(
    'https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png'
  ).addTo(map);

  const markerIcon = L.divIcon({
    className:'city-marker'
  });

  L.marker(vizag,{icon:markerIcon}).addTo(map);
  L.marker(nagpur,{icon:markerIcon}).addTo(map);

  const line = L.polyline([vizag, nagpur], {
    color:'#FF6F91',
    weight:3,
    opacity:0.7
  }).addTo(map);

  animateLine(line);

  const distance = haversine(vizag, nagpur);
  const text = document.getElementById("distanceText");
  text.innerHTML = `
  Distance means nothing when hearts stay connected.<br>
  ~${Math.round(distance)} km apart, but always close.
  `;
  setTimeout(()=> text.style.opacity = 1, 2000);
}

/* =====================================
   HAVERSINE FORMULA
===================================== */
function haversine(coord1, coord2) {
  const R = 6371;
  const dLat = (coord2[0]-coord1[0]) * Math.PI/180;
  const dLon = (coord2[1]-coord1[1]) * Math.PI/180;
  const lat1 = coord1[0] * Math.PI/180;
  const lat2 = coord2[0] * Math.PI/180;

  const a = Math.sin(dLat/2)**2 +
            Math.sin(dLon/2)**2 * Math.cos(lat1) * Math.cos(lat2);
  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
  return R * c;
}

/* =====================================
   LINE DRAW ANIMATION
===================================== */
function animateLine(line) {
  const latlngs = line.getLatLngs();
  line.setLatLngs([latlngs[0]]);

  let progress = 0;
  const interval = setInterval(()=>{
    progress += 0.02;
    if(progress >= 1){
      line.setLatLngs(latlngs);
      clearInterval(interval);
      return;
    }

    const lat = latlngs[0].lat + (latlngs[1].lat - latlngs[0].lat)*progress;
    const lng = latlngs[0].lng + (latlngs[1].lng - latlngs[0].lng)*progress;
    line.setLatLngs([latlngs[0], [lat,lng]]);
  }, 30);
}
</script>

</body>
</html>
